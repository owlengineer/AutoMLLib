# AutoMLLib

## install (Linux)

Poetry:
```commandline
cd <your_project_foldier>
poetry add git+ssh://git@github.com:owlengineer/AutoMLLib.git
```

## Ход мыслей (как делал)

### Исходная постановка

Библиотека должна решать задачу бинарной классификации для заданной выборки. Финальная модель должна выбираться на основе выбранной метрики. Решение о том, какие библиотеки использовать в коде и как будет выглядеть пайплайн обучения остаётся за тобой.

Есть два момента которые стоит учесть:

1. Стоит помнить, что твой код это именно библиотека, то есть она может использоваться другими людьми. Поэтому не забудь про readme и про примеры использования.
2. Не нужно писать библиотеку, которая будет имеет несомненную практическую ценность. Нам важно посмотреть, как у тебя получается продумывать архитектуру библиотеки и писать код на Python для автоматизации data science задач.

### Декомпозиция

1. Библиотека должна иметь понятную инструкцию к установке и описание API (примеры). 
2. Библиотека должна поддерживать множество моделей и эти модели должны иметь единый интерефейс взаимодействия с пользователем
3. Базовое API -- обучение модели, на вход пользователь подает: (1, required) датасет, заранее подготовленный; (2, optional) гиперпараметры модели и метрику, на выход -- объект  модели и расчет метрики.
4. Модель на выходе должна быть лучшей комбинацией весов (а не последней, например)
5. Покрытие тестами, которое как минимум проверяет что модели в принципе собираются и обучаются. 

### Реализация

1. Библиотека обернута в poetry-пакет с помощью pyproject.toml, README содержит примеры того, как работать с библиотекой, и как установить её в свой venv
2. Общий интерфейс сделан через общий для всех моделей класс BaseModelWrapper. В нем есть абстрактные методы которые классам-потомкам (непосредственно моделям) надо переопределить. 
3. Базовая функция для пользователя -- get_best_model(data), она запускает процесс обучения, возвращает объект модели и расчет метрики. Пользовательские конфиги модели (кол-во эпох, размер батча, метрика и тп) подаются в конструктор как словарь params -- в этом универсальность, но для каждой модели поля могут быть разные. Пример -- если использовать https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html, там параметры будут другие, нежели в реализации через нейронную сеть. 
4. Данный пункт реализовывается в методе тренировки модели самим разработчиком, поскольку реализация метода тренировки может быть разная (например если цикл обучения спрятан во внешней функции, а callback-ов как в keras-e нет)
5. Реализация подразумевает, что для каждой модели будет проводиться 2 теста -- на успешную сборку и успешное обучение. Для модели-примера на Dense слоях это сделано. Использовался pytest.